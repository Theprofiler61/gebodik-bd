# Разработка

## Сборка и тесты

```bash
./gradlew build
./gradlew test
```

## Запуск через Gradle

Сервер:

```bash
./gradlew run --args="--port 15432 --dataDir data --bufferPool 10"
```

CLI клиент:

```bash
./gradlew runCli --args="--host 127.0.0.1 --port 15432"
```

## Запуск через shell-скрипты

Сервер:

```bash
./run-server.sh
```

CLI:

```bash
./run-cli.sh
```

## Конфигурация через переменные окружения

### Сервер

| Переменная | По умолчанию | Описание |
|-----------|--------------|----------|
| `PORT` | `15432` | Порт сервера |
| `DATA_DIR` | `data` | Директория данных |
| `BUFFER_POOL` | `10` | Размер buffer pool (страниц на файл) |

### Клиент

| Переменная | По умолчанию | Описание |
|-----------|--------------|----------|
| `HOST` | `127.0.0.1` | Хост сервера |
| `PORT` | `15432` | Порт сервера |

## CLI опции

CLI поддерживает аргументы командной строки:

| Опция | Описание |
|------|----------|
| `--host <host>` | Хост сервера |
| `--port <port>` | Порт сервера |
| `--sql "<SQL>"` | Выполнить один запрос и выйти |
| `--raw` | Печатать raw JSON‑ответы |
| `--noColor` | Отключить цветной вывод |
| `--color` | Принудительно включить цвета |

Примеры:

```bash
./gradlew runCli --args='--sql "SELECT * FROM users;"'
./gradlew runCli --args="--raw --noColor"
```

## Команды интерактивного режима

| Команда | Описание |
|--------|----------|
| `\h` / `help` | Справка |
| `\q` / `exit` / `quit` | Выход |
| `\raw` | Переключить raw JSON режим |
| `\color on|off` | Включить/выключить цвета |

## Полезные приёмы

- Для диагностики протокола используйте режим raw JSON (см. CLI справку и `PROTOCOL.md`).
- Для “чистого” запуска можно удалять содержимое `data/` (директория будет создана заново).

